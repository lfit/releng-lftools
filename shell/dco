#!/bin/bash
# SPDX-License-Identifier: MIT
##############################################################################
# Copyright (c) 2018 The Linux Foundation and others.
#
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Eclipse Public License v1.0
# which accompanies this distribution, and is available at
# http://www.eclipse.org/legal/epl-v10.html
##############################################################################

# This script checks out a git repo determined by repository_url and determines if
# it contains unsigned commits.



check_dco() {
    branches=$(git branch)
    for branch in "${branches[@]}"
    do
        git checkout $branch
        echo "Checking commits in branch $branch for commits missing DCO..."
        git log --no-merges --pretty="%H" --grep 'Signed-off-by' --invert-grep * \
        | while read commit_hash; do
            echo "ERROR: Commit $commit_hash is missing Signed-off-by line."
        done
    done
}
